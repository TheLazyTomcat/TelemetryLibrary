<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<title>SCS Telemetry library: TelemetryNetCircularBuffers: Class TCircularPacketsBuffer</title>
<meta name="generator" content="PasDoc 0.13.0">
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<link rel="StyleSheet" type="text/css" href="pasdoc.css">
</head>
<body class="content">
<a name="TCircularPacketsBuffer"></a><h1 class="cio">Class TCircularPacketsBuffer</h1>
<table class="sections wide_list">
<tr>
<td><a class="section" href="#PasDoc-Description">Description</a></td><td><a class="section" href="#PasDoc-Hierarchy">Hierarchy</a></td><td><a class="section" href="#PasDoc-Fields">Fields</a></td><td><a class="section" href="#PasDoc-Methods">Methods</a></td><td><a class="section" href="#PasDoc-Properties">Properties</a></td></tr></table>
<a name="PasDoc-Description"></a><h2 class="unit">Unit</h2>
<p class="unitlink">
<a  href="TelemetryNetCircularBuffers.html">TelemetryNetCircularBuffers</a></p>
<h2 class="declaration">Declaration</h2>
<p class="declaration">
<code>type TCircularPacketsBuffer = class(<a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html">TCircularItemsBuffer</a>)</code></p>
<h2 class="description">Description</h2>
<p>
<code>TCircularPacketsBuffer</code> serves as per-connection outgoing buffer.</p>
<p>
 Server-client communication is realized trought variable size packets, when one has to be send, it is passed to connection socket. But these sockets use their own internal buffers, and when this socket buffer is full, the socket rejects to accept the packet. So the packet must be stored and sent a little later. <code>TCircularPacketsBuffer</code> is designed for this purpose.<br> When a packet is rejected, it is passed to this buffer and stored. Later, when the socket is ready to send more data, stored packet is loaded and sent.

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p></p>
<a name="PasDoc-Hierarchy"></a><h2 class="hierarchy">Hierarchy</h2>
<ul class="hierarchy"><li class="ancestor">TObject</li>
<li class="ancestor"><a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html">TCircularItemsBuffer</a></li>
<li class="thisitem">TCircularPacketsBuffer</li></ul><h2 class="overview">Overview</h2>
<a name="PasDoc-Fields"></a><h3 class="summary">Fields</h3>
<table class="summary wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="private.gif" alt="Private" title="Private"></a></td>
<td class="itemcode"><code><b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fSocket">fSocket</a></b>:          TCustomWinSocket;</code></td>
</tr>
<tr class="list2">
<td class="visibility"><a  href="legend.html"><img  src="private.gif" alt="Private" title="Private"></a></td>
<td class="itemcode"><code><b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fOnPacketDrop">fOnPacketDrop</a></b>:    <a  href="TelemetryNetPackets.html#TPacketNotifyEvent">TPacketNotifyEvent</a>;</code></td>
</tr>
</table>
<a name="PasDoc-Methods"></a><h3 class="summary">Methods</h3>
<table class="summary wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="private.gif" alt="Private" title="Private"></a></td>
<td class="itemcode"><code>Function <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#GetItemsDropped">GetItemsDropped</a></b>: Int64;</code></td>
</tr>
<tr class="list2">
<td class="visibility"><a  href="legend.html"><img  src="protected.gif" alt="Protected" title="Protected"></a></td>
<td class="itemcode"><code>procedure <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#DropItem">DropItem</a></b>(Index: Integer); override;</code></td>
</tr>
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="protected.gif" alt="Protected" title="Protected"></a></td>
<td class="itemcode"><code>procedure <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#InitializeItem">InitializeItem</a></b>(var Item: <a  href="TelemetryNetCircularBuffers.TArrayItem.html">TArrayItem</a>); override;</code></td>
</tr>
<tr class="list2">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>constructor <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#Create">Create</a></b>(aSocket: TCustomWinSocket = nil; aSize: Integer = <a  href="TelemetryNetCircularBuffers.html#def_TCircularPacketsBuffer_BufferSize">def_TCircularPacketsBuffer_BufferSize</a>);</code></td>
</tr>
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>destructor <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#Destroy">Destroy</a></b>; override;</code></td>
</tr>
<tr class="list2">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>procedure <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#Clear">Clear</a></b>; override;</code></td>
</tr>
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>procedure <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#AddPacket">AddPacket</a></b>(Packet: <a  href="TelemetryNetPackets.TPacketBuffer.html">TPacketBuffer</a>; CreateCopy: Boolean = True); virtual;</code></td>
</tr>
<tr class="list2">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>Function <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#PeekPacket">PeekPacket</a></b>: <a  href="TelemetryNetPackets.TPacketBuffer.html">TPacketBuffer</a>; virtual;</code></td>
</tr>
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>Function <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#RemovePacket">RemovePacket</a></b>: Boolean; virtual;</code></td>
</tr>
<tr class="list2">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><code>Function <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#ContainsPacket">ContainsPacket</a></b>: Boolean; virtual;</code></td>
</tr>
</table>
<a name="PasDoc-Properties"></a><h3 class="summary">Properties</h3>
<table class="summary wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="published.gif" alt="Published" title="Published"></a></td>
<td class="itemcode"><code>property <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#Socket">Socket</a></b>: TCustomWinsocket read <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fSocket">fSocket</a>;</code></td>
</tr>
<tr class="list2">
<td class="visibility"><a  href="legend.html"><img  src="published.gif" alt="Published" title="Published"></a></td>
<td class="itemcode"><code>property <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#PacketsDropped">PacketsDropped</a></b>: Int64 read <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#GetItemsDropped">GetItemsDropped</a>;</code></td>
</tr>
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="published.gif" alt="Published" title="Published"></a></td>
<td class="itemcode"><code>property <b><a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#OnPacketDrop">OnPacketDrop</a></b>: <a  href="TelemetryNetPackets.html#TPacketNotifyEvent">TPacketNotifyEvent</a> read <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fOnPacketDrop">fOnPacketDrop</a> write <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fOnPacketDrop">fOnPacketDrop</a>;</code></td>
</tr>
</table>
<h2 class="description">Description</h2>
<h3 class="detail">Fields</h3>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="private.gif" alt="Private" title="Private"></a></td>
<td class="itemcode"><a name="fSocket"></a><code><b>fSocket</b>:          TCustomWinSocket;</code></td>
</tr>
<tr><td colspan="2">
<p>
See <a class="normal" href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#Socket">Socket</a> property.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="private.gif" alt="Private" title="Private"></a></td>
<td class="itemcode"><a name="fOnPacketDrop"></a><code><b>fOnPacketDrop</b>:    <a  href="TelemetryNetPackets.html#TPacketNotifyEvent">TPacketNotifyEvent</a>;</code></td>
</tr>
<tr><td colspan="2">
<p>
Holds reference to <a class="normal" href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#OnPacketDrop">OnPacketDrop</a> event handler.</p>
</td></tr>
</table>
<h3 class="detail">Methods</h3>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="private.gif" alt="Private" title="Private"></a></td>
<td class="itemcode"><a name="GetItemsDropped"></a><code>Function <b>GetItemsDropped</b>: Int64;</code></td>
</tr>
<tr><td colspan="2">
<p>
Getter for <a class="normal" href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#PacketsDropped">PacketsDropped</a> property.

<p></p>
<h6 class="description_section">Returns</h6>
<p class="return">Number of dropped items since creation of instance.</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="protected.gif" alt="Protected" title="Protected"></a></td>
<td class="itemcode"><a name="DropItem"></a><code>procedure <b>DropItem</b>(Index: Integer); override;</code></td>
</tr>
<tr><td colspan="2">
<p>
Overrided method for memory freeing of dropped packet.<br> The <a class="normal" href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#OnPacketDrop">OnPacketDrop</a> event is called inside this method (before actual drop).

<p>See <a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html#DropItem">TCircularItemsBuffer.DropItem</a> for further info.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="protected.gif" alt="Protected" title="Protected"></a></td>
<td class="itemcode"><a name="InitializeItem"></a><code>procedure <b>InitializeItem</b>(var Item: <a  href="TelemetryNetCircularBuffers.TArrayItem.html">TArrayItem</a>); override;</code></td>
</tr>
<tr><td colspan="2">
<p>
Initializes items &quot;Data&quot; field to <a class="normal" href="TelemetryNetPackets.TPacketBuffer.html">TPacketBuffer</a> structure.

<p>See <a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html#InitializeItem">TCircularItemsBuffer.InitializeItem</a> for further info.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><a name="Create"></a><code>constructor <b>Create</b>(aSocket: TCustomWinSocket = nil; aSize: Integer = <a  href="TelemetryNetCircularBuffers.html#def_TCircularPacketsBuffer_BufferSize">def_TCircularPacketsBuffer_BufferSize</a>);</code></td>
</tr>
<tr><td colspan="2">
<p>
Object constructor.

<p> </p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>aSocket</dt>
<dd>Socket to which current instance is assigned to.</dd>
<dt>aSize</dt>
<dd>Requiered size of created buffer.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><a name="Destroy"></a><code>destructor <b>Destroy</b>; override;</code></td>
</tr>
<tr><td colspan="2">
<p>
Object destructor. Explicitly frees memory of all items.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><a name="Clear"></a><code>procedure <b>Clear</b>; override;</code></td>
</tr>
<tr><td colspan="2">
<p>
Free memory of all packets and sets all items to empty state.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><a name="AddPacket"></a><code>procedure <b>AddPacket</b>(Packet: <a  href="TelemetryNetPackets.TPacketBuffer.html">TPacketBuffer</a>; CreateCopy: Boolean = True); virtual;</code></td>
</tr>
<tr><td colspan="2">
<p>
Use this method to add new packet to the buffer.<br> If CreateCopy is set to <code>True</code> (dafault), then data are copied into new memory location and passed buffer can be then freed. If set to <code>False</code>, only pointer is stored in the item, so the passed buffer must not be freed (it will be freed automatically on item drop or when the instance is destroyed).<br> If buffer is full, then packet at current position is dropped (<a class="normal" href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#DropItem">DropItem</a> method is called) and replaced by the passed one.<br> Calls <a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html#AddItem">AddItem</a> method.

<p>

<p></p>
<h6 class="description_section">Parameters</h6>
<dl class="parameters">
<dt>Packet</dt>
<dd>Packet buffer to be added.</dd>
<dt>CreateCopy</dt>
<dd>Determines whether packet copy or reference should be added to the buffer.</dd>
</dl>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><a name="PeekPacket"></a><code>Function <b>PeekPacket</b>: <a  href="TelemetryNetPackets.TPacketBuffer.html">TPacketBuffer</a>; virtual;</code></td>
</tr>
<tr><td colspan="2">
<p>
Returns oldest stored packet.<br> If no packet is stored in the buffer, then an exception is raised (use method <a class="normal" href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#ContainsPacket">ContainsPacket</a> to check whether there is any packet stored).<br> Calls <a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html#PeekItem">PeekItem</a> method.

<p></p>
<h6 class="description_section">Returns</h6>
<p class="return">Oldest stored packet buffer.</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><a name="RemovePacket"></a><code>Function <b>RemovePacket</b>: Boolean; virtual;</code></td>
</tr>
<tr><td colspan="2">
<p>
Removes (deletes, frees used memory) oldest stored packet.<br> Calls <a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html#RemoveItem">RemoveItem</a> method.

<p></p>
<h6 class="description_section">Returns</h6>
<p class="return"><code>True</code> when packet was succesfully removed, otherwise <code>False</code>.</p></td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="public.gif" alt="Public" title="Public"></a></td>
<td class="itemcode"><a name="ContainsPacket"></a><code>Function <b>ContainsPacket</b>: Boolean; virtual;</code></td>
</tr>
<tr><td colspan="2">
<p>
Calls <a class="normal" href="TelemetryNetCircularBuffers.TCircularItemsBuffer.html#ContainsItem">ContainsItem</a> method.

<p></p>
<h6 class="description_section">Returns</h6>
<p class="return"><code>True</code> when the buffer contains at least one packet, othrewise <code>False</code>.</p></td></tr>
</table>
<h3 class="detail">Properties</h3>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="published.gif" alt="Published" title="Published"></a></td>
<td class="itemcode"><a name="Socket"></a><code>property <b>Socket</b>: TCustomWinsocket read <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fSocket">fSocket</a>;</code></td>
</tr>
<tr><td colspan="2">
<p>
Socket to which currend instance is bound.<br> Value is set during creation and thus is not initialized. Can be <code>Nil</code>.<br> This object is passed as &quot;Socket&quot; parameter in event calls.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="published.gif" alt="Published" title="Published"></a></td>
<td class="itemcode"><a name="PacketsDropped"></a><code>property <b>PacketsDropped</b>: Int64 read <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#GetItemsDropped">GetItemsDropped</a>;</code></td>
</tr>
<tr><td colspan="2">
<p>
Number of packets dropped since instance creation.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="visibility"><a  href="legend.html"><img  src="published.gif" alt="Published" title="Published"></a></td>
<td class="itemcode"><a name="OnPacketDrop"></a><code>property <b>OnPacketDrop</b>: <a  href="TelemetryNetPackets.html#TPacketNotifyEvent">TPacketNotifyEvent</a> read <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fOnPacketDrop">fOnPacketDrop</a> write <a  href="TelemetryNetCircularBuffers.TCircularPacketsBuffer.html#fOnPacketDrop">fOnPacketDrop</a>;</code></td>
</tr>
<tr><td colspan="2">
<p>
Called when stored packet is about to be dropped (deleted). Use this event if you want to save or otherwise process stored data.</p>
</td></tr>
</table>
<hr noshade size="1"><span class="appinfo"><em>Generated by <a  href="http://pasdoc.sourceforge.net/" target="_blank">PasDoc 0.13.0</a> on 2013-10-18 17:02:30</em>
</span>

</body>
</html>
